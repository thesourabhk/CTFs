# Relatively Secure Algorithm
Category: Cryptography

## Description
> The department of EEvil is plotting something, we found this file on one of the faculty's computers, can you figure out what it is?

A text file was attached.

## Solution

From the name of the challenge we can guess that it will deal with RSA.

Let's check the attached file:

```console
root@kali:/media/sf_CTFs/technion/Relatively_Secure_Algorithm# cat message.txt
n: 825402695296235131092527557949148073680565936697713051415889293421029386404087786809133592938935623042440715527196520597292373820231062072474925946687326909527522368629975724388127799086004143533106667800998091247742389330432883797178326137254716519621196100994734775290514266572830378500333765897067796562788680689472323096811097130765013612651422495467212972214772718890261379968152205135925701904909039101189937253885371003736074519018221858648225347897987181571275839640491047203059389825550936971094398683210286052266410263866826268586236692135320079545001376164284247052679177411582273091659201220480533559746778789832073166797384358086283378353771172226575876935552196797307187999859754390947734663968491410635801184266690863992131425203127607174511857095265526424765821272294690124489772026301817212579031068294287661070265211790122376389183596252269054368365643460044953455035168757432011941774411665066875107329537717590084288937539003745260571770240109942546025847595253577165758019294931157968125588233441504909248216799233514466849049223331018386938363613854548693694755488670348728528933243830892350215180587991482856241757261724154872929793486588815163210598623606769681731012749290487884299695000130785666275868697293
e: 65537
p: 28069314585108756035848513647597610834225797800860752848663474970174583353886146199571979524351943071582432045806274029311233469599712067469851757489396524898065538625303685259051652617004655873485519483592935216868737077075497584459587658263806635821766590638776567043954999826087118541685704170392342797811382391073770965485613495589480668635956714126490055489630443624764807781373683160760075607610308718540154536269918442024806008554009398902502499632794478272942027306551524058453387857194710676144975007459467710884588089828069684540736333265519800014202434206707747303838213190885409880375072009214835974060763
q: 29405872836457686696740155975471752061459340894678871416585401774963969793666715154214375047230781383467092922259450859189392703766772285358653226686220825982019500241628146951860441531787418600262163830668796766272549847511633062053686430417222251160913126359964320246656861185493206125456543856502118013637235957959059720420665579445461659902831363000300245254396321449146147551214569752002671227032896770476601561466652355314783948807259170962291180014399109715050100517158384377121647613044222041868576420086977066381810025391195532039678037753337637774929007886189968806147938877829884509966477797882366306600311
c: 173752985581892316006309343839207936229693907165489052958892359950848312889336299576455020174824693077789984817731495853868186939900601134723215299244638668430587111226648527701269403623779097763129579469082671667158619013691670818838124816687556885591416373405046318309685438295531261698025198091372600919970647551102389253278156422788571736423823729410340781877402993049766740269476840530803703216785218517001390465877628796603255994865149990229760997173725088104795416166658443058064170476042119369126154025828179008841954231984726288138946917675485818551455907708082637829854707249517458675622690416260954188680300731305306130863080509508600301877010041957474271132079988585807969778154660159258537622173214426603678402886077432903049244652555850026355950142924637754421579013988111102641267297050716750481273983213800980611936424122037336541583353536610848019315347022698709069346929620774003620853983317933409589579916225442986174429438164973159050950072811564576593323816574515340070285528333841523325601975731631707704268017718672660535895361419240717732353845053934327340095867021778739727294418774005290399920871533450941136512703665608521344152149596247521763154128507105012751058891839197323701265358726624318912749452796
```

This looks like textbook RSA where we even know the private key material.

It can easily be decoded with the following script:

```python
import gmpy2

with open("message.txt") as f:
    params = {}
    for line in f:
        name, value = line.strip().split(": ")
        params[name] = int(value)
        
    assert(params["p"] * params["q"] == params["n"])
    ph = (params["p"] - 1) * (params["q"] - 1)
    d = gmpy2.invert(params["e"], ph)
    plaintext = pow(params["c"], d, params["n"])
    print(bytes.fromhex(format(plaintext, 'x')).decode("ascii"))
```

Output:
```console
root@kali:/media/sf_CTFs/technion/Relatively_Secure_Algorithm# python3 solve.py
My dear friends of the departement of EEvil
Our sworn enemy, vaad madmach, is planning to organize a CTF competition for the student!
This is outragous! we can't let them do something like that while we organize nothing!
So I, and my colleagues at the vaad of EEvil are planning to steal all their flags and post them before the competition!
We already found this little flag on one of their computers: cstechnion{Rs4_1s_34sy_4Nd_7hIS_Is_m374}
We will publish more flags as we find them

Long live the EEmpire!
```