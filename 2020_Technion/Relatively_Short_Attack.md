# Relatively Short Attack
Category: Cryptography

## Description
> We found another message and your previous attacks didn't seem to work on it, can you decrypt this? something is a little off...

A text file was attached.

## Solution

From the name of the challenge we can guess that it will deal with RSA.

Let's check the attached file:

```console
root@kali:/media/sf_CTFs/technion/Relatively_Short_Attack# cat message.txt
n: 1036468104802883031549027575613421791563372139585888000937982803940795010661380344423326337285911149486058383604275022226220763124510094375331654754379252823453854319841096507463335266211244417359304918616059387219741515952705130354634448619473211894827624581589042882327719208980719961241411388098881279836438795334461673509112801833097522632316138621814055573961688485330159529375395638845388630274857033787986196327948351772187943603410292384937297126120904287834502752607362002084355896912959222339492370355337833962634703992984349174865988717560426562575945601191694769925297404385601570667062874831861070143791937346296529381803207057402470461713116513143094310857016536044800935412539034879195364333982456159275618086509754567547782747904253659230849642484698383234368362419194951478970198091523584976778000245430065388083028169192541854890213385834896951390133956999432510388303120653763163279782205789332191846815585125946615918428587299209266527700851075237282744554993685792843587095763210408406570617217712988322476058785475070651421425570083711208737546227782169234292093068323277885313043905945801260705273789861149013185391711504712317122223204108970538536274196190808468347286332235527199557175970544274597287754317033050771085018376869532559024879916131282264259446988250286045980776934436549557891544143923602778975712782657894321232025648507342290706283269000192728783666524083213601095399143523234916269278968003015748060236127947830964014274749855865258820586353185120866926578746519852203682007230689359918929543542713178518304553978270612093543385654023588974107443285991191737899052521647565156904536502643805491393679728872105021549324169956415246821012844827423645773045728653367956546167177256125751924990909097113734820640076959730955697935997420246504882828417493721059651897617147978308351360109960013755312247820665539443091616039773581864775394684046012300886423888030863020147592166762381743604840787016718147743750444044167672320987888981217629138929707991896073870793828632273643204736567970486647585663280078742669634529513229171261759951068994103988191929559052658125836904098395282287400455528240879860854345094115339432368342957638475998036051046694691200257945102487216488959140329729240564902127802433890134688918415741987890141499975189842713608447130479801805277763975412887886333868063702413875280893425617811714256443350337128154760036352156564300596113756690169209226453312840543126804817241031985232403851496826852627397864150304966529331767162854956595796813515935858910559414385745261761977469819263379187564779310649501524474249703179621438467655799745087127525502145071831054654994750810402210458700976061160945194786674703816724055596332171227622852280418952977046773348335815547855069821098197918498794053567608803761178413293342554940421358284116965389859917321404871624035387788996161166605351724497453872769764405316618276723883375741859883744962206076293356011415768212154906365329564313045608547258009087220871640829431288290127681287822702024802042627487378842840159587338417419011614393185401240647627799381194031424497614312000606390731066498910531421157669644123363181738575799281229440743671134929331437439490071580389848018979210381365138291876975232174547899857742337566723851894518468628974701999883512579312988164921759377475490690419539617132945742558672494594371512299043283199704753615096315737723336232914847417410619137369395797220301015302428751818260964183632968775739930436019371221754351380629006728955956637241950095280303981580679951827024839585112323891374641068997373292947282368072165058319544967141290262706687078206206502208263835947978089598056551876213965679618049157401390017210635644993658118720091807672636245457449693362719383898821411936621031976455272447231891318925687851820942869490379009741533385171601892737989982547260775052681893444535431051164446279545244894731448990623921279479152647185093618466786877198801626025031901601753768828462928204812410746227831841558751509335002904399230344860600039909376415088854196307588265968829323409660484065738840272328566011045760309619204823971327353210104426881857512308381911000386810258597947408158371902897287466040687549009953976817888742025535113670803453673093505102929096222721111415735313089413573416549571392375797466244250005245471146248526658922696632043924560245101568657741775094381145147613195122002534014516045374920395234698074601222719492153961200482808339111866883726227453710142298248492507718912404329172124600366723305794672821723873509083100953444386997080799412378445273716512682406080774844408558105445333952567413546945460758594405009334009883310682595320073114459429079648629585042596199548891361302214394080696744431402169650977022406497916449151292665100478513325139508351860896753148220003937504459502633533826419102323832140632861859387329705587410584181488978220459725041974275058185036964912339552332685350965542680964970967409020255400350255299317435081552375531
e: 3
c: 13790649541468249014836085207722101155094475533012953118911100663122580403893903500815041636852332700008241972811106846339716931746309200309832158076877697437243498800323921064666303768017380229918082414393549770435930838454903777560614328878112776422577503007941860832585126586731689337282120837345237244721036175732306617258800335568405673051154324385963427503577403760217808411902993712311399455174828040538269280378427181006415414482431821884716847617123631685427418225720523831635815921803890448252833494840426431444829247049262025732729680531293018855716025198735409215685917514523791027333254802176720521234430971388596866295763786203186999719829018519677972048139021655627832998967582024600137083469507983552722616993442150179859057601051684775242466465362684452569068930391986337648955877227279987962011237002654224177765388852968803488840528449376707801930952514260695274673114793786684016563034337702508810993029309413623292657190568826423303864872264197421305763697709581241808402880353750802867403085559313119263617883063342848807829950260211129002642441053187202739801488930864894239029921709808107736182040896756122240827751505857531782007350162191785962514869710215998476189636777996895104318039880270922701058948283595270826228877373926734181823577991741185340707751894366736099964491391409447031222596166865523106215070088914888295750312293860074288197627226885140849139300610326468857747170491159587220182197613971685147656666423534237806531111585415942829447981116161205443256455449225901847559636827719523573249133545732472086199343738168533225436193612245069925031550799330572747299026321905773161720615815036329260065908090905048665825299794028074894937466775315238595038999054382361837549766798834344881781151709002484748340968898762073557650804767607299137437188461247791032003345364662550055689540597289217907089421837893380000658836460279361549674256613109687702633198756764761752305132735679658029763564745970996314823382315549977665537498420529473354744362927560262131758996620940311393
```

Since the public exponent is very small, we can try to perform a [Low public exponent attack](https://en.wikipedia.org/wiki/Coppersmith%27s_attack#Low_public_exponent_attack). We'll use RsaCtfTool for that:

```console
root@kali:/media/sf_CTFs/technion/Relatively_Short_Attack# ~/utils/RsaCtfTool/RsaCtfTool.py --createpub -n 1036468104802883031549027575613421791563372139585888000937982803940795010661380344423326337285911149486058383604275022226220763124510094375331654754379252823453854319841096507463335266211244417359304918616059387219741515952705130354634448619473211894827624581589042882327719208980719961241411388098881279836438795334461673509112801833097522632316138621814055573961688485330159529375395638845388630274857033787986196327948351772187943603410292384937297126120904287834502752607362002084355896912959222339492370355337833962634703992984349174865988717560426562575945601191694769925297404385601570667062874831861070143791937346296529381803207057402470461713116513143094310857016536044800935412539034879195364333982456159275618086509754567547782747904253659230849642484698383234368362419194951478970198091523584976778000245430065388083028169192541854890213385834896951390133956999432510388303120653763163279782205789332191846815585125946615918428587299209266527700851075237282744554993685792843587095763210408406570617217712988322476058785475070651421425570083711208737546227782169234292093068323277885313043905945801260705273789861149013185391711504712317122223204108970538536274196190808468347286332235527199557175970544274597287754317033050771085018376869532559024879916131282264259446988250286045980776934436549557891544143923602778975712782657894321232025648507342290706283269000192728783666524083213601095399143523234916269278968003015748060236127947830964014274749855865258820586353185120866926578746519852203682007230689359918929543542713178518304553978270612093543385654023588974107443285991191737899052521647565156904536502643805491393679728872105021549324169956415246821012844827423645773045728653367956546167177256125751924990909097113734820640076959730955697935997420246504882828417493721059651897617147978308351360109960013755312247820665539443091616039773581864775394684046012300886423888030863020147592166762381743604840787016718147743750444044167672320987888981217629138929707991896073870793828632273643204736567970486647585663280078742669634529513229171261759951068994103988191929559052658125836904098395282287400455528240879860854345094115339432368342957638475998036051046694691200257945102487216488959140329729240564902127802433890134688918415741987890141499975189842713608447130479801805277763975412887886333868063702413875280893425617811714256443350337128154760036352156564300596113756690169209226453312840543126804817241031985232403851496826852627397864150304966529331767162854956595796813515935858910559414385745261761977469819263379187564779310649501524474249703179621438467655799745087127525502145071831054654994750810402210458700976061160945194786674703816724055596332171227622852280418952977046773348335815547855069821098197918498794053567608803761178413293342554940421358284116965389859917321404871624035387788996161166605351724497453872769764405316618276723883375741859883744962206076293356011415768212154906365329564313045608547258009087220871640829431288290127681287822702024802042627487378842840159587338417419011614393185401240647627799381194031424497614312000606390731066498910531421157669644123363181738575799281229440743671134929331437439490071580389848018979210381365138291876975232174547899857742337566723851894518468628974701999883512579312988164921759377475490690419539617132945742558672494594371512299043283199704753615096315737723336232914847417410619137369395797220301015302428751818260964183632968775739930436019371221754351380629006728955956637241950095280303981580679951827024839585112323891374641068997373292947282368072165058319544967141290262706687078206206502208263835947978089598056551876213965679618049157401390017210635644993658118720091807672636245457449693362719383898821411936621031976455272447231891318925687851820942869490379009741533385171601892737989982547260775052681893444535431051164446279545244894731448990623921279479152647185093618466786877198801626025031901601753768828462928204812410746227831841558751509335002904399230344860600039909376415088854196307588265968829323409660484065738840272328566011045760309619204823971327353210104426881857512308381911000386810258597947408158371902897287466040687549009953976817888742025535113670803453673093505102929096222721111415735313089413573416549571392375797466244250005245471146248526658922696632043924560245101568657741775094381145147613195122002534014516045374920395234698074601222719492153961200482808339111866883726227453710142298248492507718912404329172124600366723305794672821723873509083100953444386997080799412378445273716512682406080774844408558105445333952567413546945460758594405009334009883310682595320073114459429079648629585042596199548891361302214394080696744431402169650977022406497916449151292665100478513325139508351860896753148220003937504459502633533826419102323832140632861859387329705587410584181488978220459725041974275058185036964912339552332685350965542680964970967409020255400350255299317435081552375531 -e 3 > key.pub
root@kali:/media/sf_CTFs/technion/Relatively_Short_Attack# python3 ~/utils/RsaCtfTool/RsaCtfTool.py --publickey key.pub --attack cube_root --uncipher 1379064954146824
9014836085207722101155094475533012953118911100663122580403893903500815041636852332700008241972811106846339716931746309200309832158076877697437243498800323921064666303
7680173802299180824143935497704359308384549037775606143288781127764225775030079418608325851265867316893372821208373452372447210361757323066172588003355684056730511543
2438596342750357740376021780841190299371231139945517482804053826928037842718100641541448243182188471684761712363168542741822572052383163581592180389044825283349484042
6431444829247049262025732729680531293018855716025198735409215685917514523791027333254802176720521234430971388596866295763786203186999719829018519677972048139021655627
8329989675820246001370834695079835527226169934421501798590576010516847752424664653626844525690689303919863376489558772272799879620112370026542241777653888529688034888
4052844937670780193095251426069527467311479378668401656303433770250881099302930941362329265719056882642330386487226419742130576369770958124180840288035375080286740308
5559313119263617883063342848807829950260211129002642441053187202739801488930864894239029921709808107736182040896756122240827751505857531782007350162191785962514869710
2159984761896367779968951043180398802709227010589482835952708262288773739267341818235779917411853407077518943667360999644913914094470312225961668655231062150700889148
8829575031229386007428819762722688514084913930061032646885774717049115958722018219761397168514765666642353423780653111158541594282944798111616120544325645544922590184
7559636827719523573249133545732472086199343738168533225436193612245069925031550799330572747299026321905773161720615815036329260065908090905048665825299794028074894937
4667753152385950389990543823618375497667988343448817811517090024847483409688987620735576508047676072991374371884612477910320033453646625500556895405972892179070894218
3789338000065883646027936154967425661310968770263319875676476175230513273567965802976356474597099631482338231554997766553749842052947335474436292756026213175899662094
0311393
private argument is not set, the private key will not be displayed, even if recovered.

[*] Testing key key.pub.
[*] Performing cube_root attack on key.pub.

Results for key.pub:

Unciphered data :
HEX : 0x4d79206465617220667269656e6473206f6620746865206465706172746d656e74206f6620454576696c0a56616164206d61646d616368206d616e6167656420616761696e20746f2064656372797074206f75722070726576696f7573206d657373616765210a546f206369726d75766d656e742074686973207765206465636964656420746f206368616e6765206f7572207075626c6963206578706f6e656e7420746f20736f6d657468696e67206d6f72652065736f74657269630a486572652069732061206e657720666c616720776520666f756e643a206373746563686e696f6e7b64306e745f7573335f536d346c6c5f337870306e336e74357d0a0a4c6f6e67206c697665207468652045456d7069726521
INT (big endian) : 239806844248210192302287736032486879627500384419021644316980250474365241780404175997555727164217623369492658529958194520601437755077053290911060884758288543338435746883839839331569107581541674020509384984744863445445832736314508771380316081923787253630335854116076339039890101309814270689276713372903329285890881783674104709087343376001303919573622079911948786649515818258595819760858132610973278933810843134462661212473610599449884141131540444514115952386717632697854023982308485268618606791275042957576816576972627024913483558908435108468572211870241540604941918421504626709974725634710214948135311092849995858206058840511910168816896020738975275685679642193039323194657
INT (little endian) : 103373307429992451375970759674763097702561136727796741714147704878787305958383911042503310341962847161039395162297595129509069319861055745337968814287709693028570632168211767373049235170180900401625476112908358766531798805066247247052022999474263384426353985304422882643076770851346179940298632874107189110415980367923556763642278532479094698128460236360700792651111935034622363907132499889431127531001231207526794134978208659638809878741441359023783633249369189733449779007829664286108045230203746609303416528067760794026303684036886395644924860995607228544125272627529777603633651976955562254844645336245622260352732878643098144207639850429165193183556109424679404468557
STR : b'My dear friends of the department of EEvil\nVaad madmach managed again to decrypt our previous message!\nTo cirmuvment this we decided to change our public exponent to something more esoteric\nHere is a new flag we found: cstechnion{d0nt_us3_Sm4ll_3xp0n3nt5}\n\nLong live the EEmpire!'
```